let players=[],smallSwissPlayers=[],smallSwissPlayersCount=0;function makeNewList(){smallSwissPlayers=[];for(let e=1;e<8;e++){let t="td-player-"+e;document.getElementById(t).innerHTML="",t="td-player-"+e+"b",document.getElementById(t).innerHTML=""}smallSwissPlayersCount=0,document.getElementById("pairing-table").classList.remove("active"),document.getElementById("pairing-cards").classList.remove("active");for(let l=0;l<players.length;l++)isNaN(players[l].rating)?players[l].rating=0:(ratingAsNumber=Number(players[l].rating),players[l].rating=ratingAsNumber);players.sort((e,t)=>t.rating-e.rating);let s=document.querySelector("#quad-list"),a=document.querySelector("#printable-quads");s.innerHTML="",a.innerHTML="";let r=!1,d=0,n=0,i=0;for(let p=0;p<players.length;p++){if(n=players.length-p,0==(d=p%4)){if(n>7||4==n){i++;let y=document.createElement("h4");y.className="quad-title",y.innerHTML=`Quad ${i}`,s.appendChild(y),g("quad",i)}else if(!1===r){i++;let m=document.createElement("h4");m.className="quad-title",m.innerHTML="Small Swiss",s.appendChild(m),r=!0,g("swiss",i)}}let c=document.createElement("p");c.className="quad-player",c.innerHTML=players[p].first.toUpperCase()+" "+players[p].last.toUpperCase()+" ("+players[p].rating+") "+players[p].id,s.appendChild(c);let o=document.createElement("tr");if(o.className="quad-row",o.id=`player-${p}`,!0===r){smallSwissPlayers[++smallSwissPlayersCount]=`${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}`;let u=`td-player-${smallSwissPlayersCount}`;document.getElementById(u).innerHTML=smallSwissPlayers[smallSwissPlayersCount],document.getElementById(u+"b").innerHTML=smallSwissPlayers[smallSwissPlayersCount],u=`swiss-player-${smallSwissPlayersCount}`,document.getElementById(u).innerHTML=smallSwissPlayers[smallSwissPlayersCount],o.innerHTML=`<tr><td>${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}<br />&nbsp; &nbsp; (${players[p].rating}) ${players[p].id}<td></td><td></td><td></td><td></td><td></td><td></td></tr>`}else switch(d){case 0:o.innerHTML=`<tr><td>${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}<br />&nbsp; &nbsp; (${players[p].rating}) ${players[p].id}<td>white vs 4</td><td>black vs 4</td><td>black vs 3</td><td>white vs 3</td><td>white vs 2</td><td>black vs 2</td></tr>`;break;case 1:o.innerHTML=`<tr><td>${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}<br />&nbsp; &nbsp; (${players[p].rating}) ${players[p].id}<td>white vs 3</td><td>black vs 3</td><td>black vs 4</td><td>white vs 4</td><td>black vs 1</td><td>white vs 1</td></tr>`;break;case 2:o.innerHTML=`<tr><td>${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}<br />&nbsp; &nbsp; (${players[p].rating}) ${players[p].id}<td>black vs 2</td><td>white vs 2</td><td>white vs 1</td><td>black vs 1</td><td>white vs 4</td><td>black vs 4</td></tr>`;break;case 3:o.innerHTML=`<tr><td>${players[p].first.toUpperCase()} ${players[p].last.toUpperCase()}<br />&nbsp; &nbsp; (${players[p].rating}) ${players[p].id}<td>black vs 1</td><td>white vs 1</td><td>white vs 2</td><td>black vs 2</td><td>black vs 3</td><td>white vs 3</td></tr>`}document.getElementById(`quad-${i}`).appendChild(o)}function g(e,t){let l=document.createElement("table");"swiss"==e?l.className="small-swiss-table quad-table table":l.className="quad-table table",l.id=`quad-${t}`;let s=document.createElement("tr");s.className="title-row";let r=document.createElement("th");r.className="title-cell","swiss"==e?(r.innerHTML="Small Swiss",document.getElementById("pairing-table").classList.add("active"),document.getElementById("pairing-cards").classList.add("active")):r.innerHTML=`Quad ${t}`,s.appendChild(r);let d=document.createElement("td");d.className="round-title-cell",d.innerHTML="Rnd 1",s.appendChild(d);let n=document.createElement("td");n.className="round-title-cell",n.innerHTML="Rnd 2",s.appendChild(n);let i=document.createElement("td");i.className="round-title-cell",i.innerHTML="Rnd 3",s.appendChild(i),l.appendChild(s);let p=document.createElement("td");p.className="round-title-cell",p.innerHTML="Rnd 4",s.appendChild(p),l.appendChild(s);let y=document.createElement("td");y.className="round-title-cell",y.innerHTML="Rnd 5",s.appendChild(y),l.appendChild(s);let m=document.createElement("td");m.className="round-title-cell",m.innerHTML="Rnd 6",s.appendChild(m),l.appendChild(s),a.appendChild(l)}}function clearForm(){let e=document.querySelector("#add-player"),t=e.querySelectorAll(".form-control");forEach(t,function(){t.value=""})}null===localStorage.getItem("players")?players=[]:(players=JSON.parse(localStorage.getItem("players")),makeNewList()),document.querySelector("#add-player").addEventListener("submit",function(e){first=document.getElementById("form-first").value,last=document.getElementById("form-last").value,rating=document.getElementById("form-rating").value,0==(id=document.getElementById("form-id").value)&&(id=(100+players.length).toString());let t={first:first,last:last,id:id,rating:rating};players.push(t),localStorage.setItem("players",JSON.stringify(players)),makeNewList(),document.getElementById("add-player").reset(),document.getElementById("form-first").focus(),e.preventDefault()}),document.querySelector("#search-player-btn").addEventListener("click",function(e){let t="";(id=document.getElementById("form-id").value).length<1&&last.length<1?alert("You will need to provide a USCF ID."):t="https://uschess.org/msa/thin3.php?"+id,document.getElementById("uscf-frame").src=t}),document.querySelector("#remove-player-btn").addEventListener("click",function(e){if((idToRemove=document.getElementById("form-delete-id").value).length>0){"DELETE ALL"==document.getElementById("form-delete-id").value&&(players=[]);for(let t=0;t<players.length;t++)(thisID=players[t].id)===idToRemove&&players.splice(t,1);document.getElementById("form-delete-id").value="",localStorage.setItem("players",JSON.stringify(players)),makeNewList()}});